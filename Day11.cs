public class Day11 : IDay
{
    public string Number => "11";

    public string Part1() => $"Test: {Impl(Test, 2)} (verwacht 374)\nReal: {Impl(Input, 2)} (correct 9627977)";

    public string Part2() => $"Test: {Impl(Test, 10)} (verwacht 1030)\nTest: {Impl(Test, 100)} (verwacht 8410)\nReal: {Impl(Input, 1_000_000)} (correct 644248339497)";

    private string Impl(string input, int multiplier)
    {
        var grid = ParseGrid(input);
        var emptyCols = Enumerable.Range(0, grid.GetLength(0))
            .Where(x => !Enumerable.Range(0, grid.GetLength(1)).Any(y => grid[x, y]))
            .ToList();
        var emptyRows = Enumerable.Range(0, grid.GetLength(1))
            .Where(y => !Enumerable.Range(0, grid.GetLength(0)).Any(x => grid[x, y]))
            .ToList();

        var galaxies = new List<Point>();
        for (var y = 0; y < grid.GetLength(1); y++)
        {
            for (var x = 0; x < grid.GetLength(0); x++)
            {
                if (grid[x, y])
                {
                    galaxies.Add(new Point(x, y));
                }
            }
        }
        var total = 0L;
        while (galaxies.Count > 1)
        {
            var galaxy1 = galaxies.First();
            galaxies = galaxies.Skip(1).ToList();
            foreach (var galaxy2 in galaxies)
            {
                var minX = Min(galaxy1.X, galaxy2.X);
                var maxX = Max(galaxy1.X, galaxy2.X);
                var minY = Min(galaxy1.Y, galaxy2.Y);
                var maxY = Max(galaxy1.Y, galaxy2.Y);
                var distance = maxX - minX + maxY - minY
                    + (multiplier - 1) * emptyCols.Count(x => minX < x && x < maxX)
                    + (multiplier - 1) * emptyRows.Count(y => minY < y && y < maxY);
                total += distance;
            }
        }
        return total.ToString();
    }

    private string Impl2(string input, int multiplier)
    {
        return "";
    }

    private bool[,] ParseGrid(string input)
    {
        var lines = input.Split(Environment.NewLine);
        var result = new bool[lines[0].Length, lines.Length];
        for (var y = 0; y < lines.Length; y++)
        {
            for (var x = 0; x < lines[0].Length; x++)
            {
                result[x, y] = lines[y][x] == '#';
            }
        }
        return result;
    }

    private const string Test =
        """
        ...#......
        .......#..
        #.........
        ..........
        ......#...
        .#........
        .........#
        ..........
        .......#..
        #...#.....
        """;

    private const string Input =
        """
        ..............................#.........................#.......................#..............................#.........................#..
        ....#.....#...................................#.............................................................................................
        .....................................#..................................#...................................................................
        ...................................................#....................................................................#...................
        ...............................................................#..................#...............................#.........................
        ...............#.......................................#...................................#.....#.......#.........................#........
        ............................................................................................................................................
        ............................................................................#...............................................................
        .......#.......................#....................#.......................................................................................
        ........................#..................#....................................................................#...........................
        ..#.......................................................#.........#....................#....................................#.............
        ..............#...........................................................#..........................................................#......
        ......................................#...........................................#..........................#..............................
        .....................................................#.........#..........................................................................#.
        #.......#....................................#.................................................#............................................
        ..............................#.......................................#..............#....................#..........#......................
        ....#...................................#...................................................................................................
        ....................................................................................................#.......................................
        .....................#...........#...............................................#..................................................#.......
        ...............................................#.........#..................................................#..................#............
        ..........................................................................#...............#........................#........................
        .................#.......................................................................................................#..................
        ......................................................................................#..................#..............................#...
        .............#...................................................................................#..........................................
        #...........................#..........#....................................................................................................
        .........#........................................................................#...............................#.........................
        .....................#.........................#.....................................................#....................#......#..........
        .....................................................................#......................................................................
        ................................#.....................................................................................................#.....
        ...............#..........................................#.................#................#..............................................
        ....................................#...........................#...........................................#...............................
        .......#...................#................#.......................................#..............................#......................#.
        ......................#.................................................#................................................#..................
        ....................................................#......................................#............#...................................
        .............#........................#..........................................................#.............#............................
        ...................#..............................................................#.........................................................
        .........................................................#..................#..........#....................................................
        ........................#.....................#..............................................#.........................................#....
        .................................................................#.........................................#...................#............
        ...................................................#........#.....................................#......................#..................
        .........#....................#.......#................................................................#............#.......................
        #.............................................................................#.....................................................#.......
        ..................#.......#.................................................................................................................
        .............#........................................................#........................#................#..........#..............#.
        .....................................................#......................................................................................
        .......#...............#.................#......................#................#..........................................................
        ...................................#.....................................................#............................#.....................
        ............................................................................................................................................
        ...............................#........................................#.........................#.........................................
        .....#.........#...............................#...................#.....................................................................#..
        ............................................................................................................................................
        ..........#......................................................................#..........................................................
        .........................................#.............................................#......#...................#...................#.....
        ........................#.....#........................................................................#....................................
        ...................................................#.....#...................#..............................................................
        ....................................................................#...............#....................................#........#.........
        ...........................#..............................................................#.................................................
        ...#........................................#.........#.......................................................#..............#..............
        ..........#....................................................#................#...........................................................
        ..................................#..................................................................................#...............#......
        .................#..........................................................................................................................
        ............................................................................................................................................
        ............................#.............#................................#.........................#.....................#................
        .........#.........................................#............#.........................#............................................#....
        ....#................................................................#.........................#..............#.............................
        ...................#......................................#.................................................................................
        ..............................#......#..............................................#..............#................#.......................
        .............................................................................#..............................................................
        .......#.........................................................................................................................#..........
        ..............#............#....................#...................#............#.......#.................................#................
        ................................#......................#................................................#.................................#.
        ............................................................................................................................................
        .#......................#......................................#...............................................#............................
        ........................................................................#............................#......................................
        ..................................................#..........................#..........................................#.......#...........
        .........................................#..........................................#....................#..............................#...
        ......#...............#.................................#...................................................................................
        ....................................#.......................................................................................................
        ...............................................................#................#........#.........................#..........#.............
        ..#........#.....#..........#...................#...................................................#.......................................
        .......................................#...........................#...........................................#............................
        .............................................................................#..............................................................
        .......................#..................................#............#...............#.......#.....................................#......
        ............................................................................................................................................
        ............#.....#................................#...........#...................................................#............#...........
        ...........................................#..............................................#.................................................
        ..................................#..............................................#.....................#....................................
        ..................................................................#.........................................................................
        ...#..........................#............................................#................................................................
        .......................................................#..........................................#........#........#.......................
        .......................................#.................................................................................#......#...........
        .................................................#..........#.........#.......................#.............................................
        ............................................................................................................................................
        ....#...........#........................................................................................#.......#...........#..............
        ......................#...........#.......#....................#..............#.....#.......................................................
        .........#...............................................................................#..................................................
        ..................................................#.........................................................................................
        ...................#......................................#...........................................#...........................#......#..
        .............#..........#.....................#....................#........................................................................
        ...............................................................................#.....#.....#.................#......#.......................
        ...#.........................#...................................................................#........................#.................
        ............................................................................................................................................
        .......#.........#..........................................#...............................................................................
        .................................#..............................................................................................#...........
        ........................................................................#..............#.......#..................#........................#
        .#...................................#......#......#........................................................................................
        ............................................................................................................................................
        .............#................#............................................................#..............#.................................
        ......#.....................................................#.......................#................#...............................#......
        ...................#..............................................#.......................................................#.................
        ....................................#.....................................#.................................................................
        ........................................................................................................#.......#...........................
        ....#.....................................#...............#...................#...............#.........................................#...
        .....................................................................................#......................................................
        ....................................................#...........#......................................................#............#.......
        ........................#...................................................................................#...............................
        ............................................................................#.....#.........#......................#........................
        ...#.....#.....#.......................#....................................................................................................
        ............................................................................................................................................
        ......................................................................#.....................................................................
        ......................................................................................#............#..........................#.............
        .....#.............#.........................................................#................#.............................................
        ..............................#..........#............#.....#...........................................................#.............#.....
        ........................................................................#................#..................................................
        ..................................................................................#.........................................................
        ......................#.............#....................#........................................................#.........................
        .................#................................#.............#.............#.............................................................
        ............................................................................................................................................
        ...#..........................#.............#....................................................#.......#...............#.........#........
        ........#...........#.................#..................................................................................................#..
        ..............#.................................#.....#..........................................................#..........................
        ...........................................................#......#.........................................................................
        ............................#..................................................#.....................................#......................
        ...................................................#.......................................#................................................
        .#................#................#...............................................#...........................................#.....#......
        .............#....................................................................................................#.........................
        .........................#...........................................#.....#......................#..........#..............................
        ........................................#...................#...........................................#...................................
        ...#......#............................................................................#....................................................
        ...............................................#.......................................................................#....................
        """;
}
